// mB v7.14.8 on 2020-02-15T00:39:57.361Z
/**
 * Copyright (c) 2014, 2019 The xterm.js authors. All rights reserved.
 * @license MIT
 *
 * Implements the attach method, that attaches the terminal to a WebSocket stream.
 */
class AttachAddon{constructor(s,t){this._disposables=[],this._socket=s,this._socket.binaryType="arraybuffer",this._bidirectional=!t||!1!==t.bidirectional}activate(s){this._disposables.push(addSocketListener(this._socket,"message",t=>{const e=t.data
s.write("string"==typeof e?e:new Uint8Array(e))})),this._bidirectional&&this._disposables.push(s.onData(s=>this._sendData(s))),this._disposables.push(addSocketListener(this._socket,"close",()=>this.dispose())),this._disposables.push(addSocketListener(this._socket,"error",()=>this.dispose()))}dispose(){this._disposables.forEach(s=>s.dispose())}_sendData(s){1===this._socket.readyState&&this._socket.send(s)}}function addSocketListener(s,t,e){return s.addEventListener(t,e),{dispose:()=>{e&&s.removeEventListener(t,e)}}}